CMAKE_MINIMUM_REQUIRED(VERSION 3.18...3.23)

PROJECT(nets LANGUAGES C CXX)

# C CXX Compiler
SET(CMAKE_C_COMPILER "/usr/bin/gcc")
SET(CMAKE_CXX_COMPILER "/usr/bin/g++")


SET(CMAKE_CXX_STANDARD 11)
SET(CMAKE_CXX_STANDARD_REQUIRED ON)

# 开启ctest
ENABLE_TESTING()

# Definition
# 日志等级，默认DEBUG。可选：TRACE,DEBUG,INFO,WARN,ERROR,FATAL；
ADD_DEFINITIONS(-DLOG_LEVEL=TRACE)
# 日志输出目标，默认STDOUT。可选：STDOUT,SINGLE_FILE，DAILY_FILE，ROLLING_FILE；
ADD_DEFINITIONS(-DLOG_WRITER_TYPE=STDOUT)
# 日志文件，默认为：“/tmp/nets/nets.log”，请使用绝对路径；
ADD_DEFINITIONS(-DLOG_FILE="/tmp/nets/nets.log")
# 日志文件回滚大小，单位:MB，默认24M。（仅当LOG_WRITER为ROLLING_FILE时有效）
ADD_DEFINITIONS(-DLOG_FILE_ROLLING_SIZE=24)

IF(NOT CMAKE_BUILD_TYPE)
    SET(CMAKE_BUILD_TYPE "Release")
ENDIF()

MESSAGE(STATUS "======CMAKE_BUILD_TYPE: ${CMAKE_BUILD_TYPE}======")

IF(${CMAKE_BUILD_TYPE} STREQUAL "Release")
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O2 -DNDEBUG")
ELSE()
    OPTION(BUILD_NETS_TESTS "Build nets tests" ON)
    OPTION(BUILD_NETS_EXAMPLES "Build nets examples" ON)
    SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O0")
    SET(GOOGLE_TEST_INC_DIR ${PROJECT_SOURCE_DIR}/third_party/googletest/include)
    SET(GOOGLE_TEST_LIB_DIR ${PROJECT_SOURCE_DIR}/third_party/googletest/lib)
ENDIF()

# CXX Compiler Flags
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11 -g \
-Wall \
-Wextra \
-Werror \
-Wno-unused-parameter \
")

MESSAGE(STATUS "======CMAKE_CXX_FLAGS: ${CMAKE_CXX_FLAGS}======")

#set(EXECUTABLE_OUTPUT_PATH ${PROJECT_BINARY_DIR}/bin)
#set(LIBRARY_OUTPUT_PATH ${PROJECT_BINARY_DIR}/lib)

INCLUDE_DIRECTORIES(${PROJECT_SOURCE_DIR})
ADD_SUBDIRECTORY(base)
